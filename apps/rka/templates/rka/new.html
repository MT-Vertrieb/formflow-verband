{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="card">
  <h3>Reisekostenantrag â€“ {% if mode == "edit" %}Bearbeiten{% else %}Neu{% endif %}</h3>

  {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if created %}
    <p><strong>Antrag erstellt:</strong> #{{ tr.id }}</p>

    <h4>Genehmigungsreihenfolge</h4>
    {% if sequence %}
      <ol>
        {% for f in sequence %}
          <li>{{ f.name }}</li>
        {% endfor %}
      </ol>
    {% else %}
      <p class="muted">Es wurde keine Genehmigungsreihenfolge ermittelt.</p>
    {% endif %}

    <div style="margin-top:12px;">
      <a href="{% url 'rka:rka_new' %}" class="btn">Neuen Test starten</a>
      <a href="{% url 'dashboard' %}" class="btn" style="margin-left:8px;">ZurÃ¼ck zum Dashboard</a>
      {% if tr.id %}
        <a href="{% url 'rka:rka_detail' tr.id %}" class="btn" style="margin-left:8px;">Zum Detail</a>
      {% endif %}
    </div>

  {% else %}
    <form method="post" novalidate>
      {% csrf_token %}
      {{ form.non_field_errors }}

      <div style="margin-bottom:8px;">
        <label for="{{ form.step1_function.id_for_label }}"><strong>Entscheider Nr. 1 (Funktion):</strong></label><br>
        {{ form.step1_function }}
        {% if form.step1_function.errors %}
          <div class="errorlist">{{ form.step1_function.errors }}</div>
        {% endif %}
      </div>

      <button type="submit">Sequenz anzeigen</button>
    </form>

    <p class="muted" style="margin-top:8px;">
      Hinweis: Die Schritte 2â€“5 kommen aus â€žEinstellungen â†’ Module approval configs (RKA)â€œ. Leere Schritte werden Ã¼bersprungen.
    </p>
  {% endif %}
</div>
{% endblock %}



